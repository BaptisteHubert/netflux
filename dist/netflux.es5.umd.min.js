!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.netflux=e.netflux||{})}(this,function(e){"use strict";function n(e){var n={connector:pe,topology:me,signalingURL:"wss://sigver-coastteam.rhcloud.com:8443",iceServers:[{urls:"stun:turn01.uswest.xirsys.com"}],listenOn:""},t=Object.assign({},n,e);return new K(t)}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),o=function e(n,t,i){null===n&&(n=Function.prototype);var r=Object.getOwnPropertyDescriptor(n,t);if(void 0===r){var o=Object.getPrototypeOf(n);return null===o?void 0:e(o,t,i)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(i)},s=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)},a=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n},c=6e4,u=new Map,d=new Map,l=function(){function e(n){i(this,e),this.id=n,u.has(this.id)||u.set(this.id,new WeakMap),d.has(this.id)||d.set(this.id,new WeakMap)}return r(e,[{key:"setPendingRequest",value:function(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c;this.setTo(d,e,n,t),setTimeout(function(){t.reject("Pending request timeout")},i)}},{key:"getPendingRequest",value:function(e,n){return this.getFrom(d,e,n)}},{key:"setItem",value:function(e,n,t){this.setTo(u,e,n,t)}},{key:"getItem",value:function(e,n){return this.getFrom(u,e,n)}},{key:"getItems",value:function(e){var n=u.get(this.id).get(e);return n?n:new Map}},{key:"removeItem",value:function(e,n){var t=u.get(this.id),i=t.get(e);t.get(e).delete(n),0===i.size&&t.delete(e)}},{key:"getFrom",value:function(e,n,t){var i=e.get(this.id).get(n);if(void 0!==i){var r=i.get(t);if(void 0!==r)return r}return null}},{key:"setTo",value:function(e,n,t,i){var r=e.get(this.id),o=void 0;r.has(n)?o=r.get(n):(o=new Map,r.set(n,o)),o.has(t)||o.set(t,i)}}]),e}(),h=function(e){function n(){return i(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s(n,e),r(n,[{key:"connectTo",value:function(e,n){var t=this,i=[];return 0===n.length?Promise.resolve(i):new Promise(function(r,o){var s=0,a=Ce.get(ye);n.forEach(function(o){a.connectTo(e,o).then(function(e){return t.onChannel(e)}).then(function(){++s===n.length&&r(i)}).catch(function(e){i.push({id:o,reason:e}),++s===n.length&&r(i)})})})}},{key:"add",value:function(e){throw new Error("Must be implemented by subclass!")}},{key:"broadcast",value:function(e,n){throw new Error("Must be implemented by subclass!")}},{key:"sendTo",value:function(e,n,t){throw new Error("Must be implemented by subclass!")}},{key:"leave",value:function(e){throw new Error("Must be implemented by subclass!")}}]),n}(l),f=1,p=2,v=3,g=4,y=5,m=function(e){function n(){return i(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s(n,e),r(n,[{key:"add",value:function(e){var t=this,i=e.webChannel,r=i.members.slice(),s=!0,a=!1,c=void 0;try{for(var u,d=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItems",this).call(this,i).keys()[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var l=u.value;r[r.length]=l}}catch(e){a=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(a)throw c}}return this.setJP(i,e.peerId,e),i.sendInner(this.id,{code:f,jpId:e.peerId}),i.sendInnerTo(e,this.id,{code:p,peers:r}),new Promise(function(r,s){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setPendingRequest",t).call(t,i,e.peerId,{resolve:r,reject:s})})}},{key:"broadcast",value:function(e,n){var t=!0,i=!1,r=void 0;try{for(var o,s=e.channels[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;a.send(n)}}catch(e){i=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw r}}}},{key:"sendTo",value:function(e,n,t){var i=!0,r=!1,o=void 0;try{for(var s,a=n.channels[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;if(c.peerId===e)return void c.send(t)}}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"sendInnerTo",value:function(e,t,i){if(e===t.myId)t.onChannelMessage(null,i);else{var r=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,t,t.myId);null===r&&(r=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,t,e)),null!==r?r.channel.send(i):t.members.includes(e)?this.sendTo(e,t,i):this.sendTo(t.members[0],t,i)}}},{key:"sendInner",value:function(e,t){var i=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,e,e.myId);null===i?this.broadcast(e,t):i.channel.send(t)}},{key:"leave",value:function(e){var n=!0,t=!1,i=void 0;try{for(var r,o=e.channels[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var s=r.value;s.clearHandlers(),s.close()}}catch(e){t=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(t)throw i}}e.channels.clear()}},{key:"onChannel",value:function(e){var t=this;return new Promise(function(i,r){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setPendingRequest",t).call(t,e.webChannel,e.peerId,{resolve:i,reject:r}),e.webChannel.sendInnerTo(e,t.id,{code:g})})}},{key:"onChannelClose",value:function(e,t){var i=t.webChannel,r=!0,s=!1,a=void 0;try{for(var c,u=i.channels[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var d=c.value;if(d.peerId===t.peerId)return i.channels.delete(d)}}catch(e){s=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(s)throw a}}var l=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItems",this).call(this,i);return l.forEach(function(e){return e.channels.delete(t)}),!1}},{key:"onChannelError",value:function(e,n){console.error("Channel error with id: "+n.peerId+": ",e)}},{key:"onMessage",value:function(e,t,i,r){var s=this,a=e.webChannel,c=void 0;switch(r.code){case p:c=this.setJP(a,a.myId,e),c.channels.add(e),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"connectTo",this).call(this,a,r.peers).then(function(e){var t={code:v};c.channels.forEach(function(e){a.sendInnerTo(e,s.id,t),a.channels.add(e),a.onPeerJoin$(e.peerId)}),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeItem",s).call(s,a,a.myId),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItems",s).call(s,a).forEach(function(e){return a.sendInnerTo(e.channel,s.id,t)}),a.onJoin()});break;case v:if(c=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,a,a.myId),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeItem",this).call(this,a,t),null!==c)c.channels.add(e);else{a.channels.add(e),a.onPeerJoin$(t);var u=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getPendingRequest",this).call(this,a,t);null!==u&&u.resolve(t)}break;case g:this.setJP(a,t,e);var d=null!==o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,a,a.myId);a.sendInnerTo(e,this.id,{code:y,isJoining:d});break;case y:r.isJoining?this.setJP(a,t,e):o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,a,a.myId).channels.add(e),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getPendingRequest",this).call(this,a,t).resolve();break;case f:this.setJP(a,r.jpId,e)}}},{key:"setJP",value:function(e,t,i){var r=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,e,t);return r?r.channel=i:(r=new w(i),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setItem",this).call(this,e,t,r)),r}}]),n}(h),w=function e(n,t){i(this,e),this.channel=n,this.channels=new Set};!function e(n,t,i){function r(s,a){if(!t[s]){if(!n[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=t[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return r(t?t:e)},d,d.exports,e,n,t,i)}return t[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,n,t){},{}],2:[function(e,n,t){!function(){var t=e("./utils"),i=t.log,r=t.browserDetails;n.exports.browserDetails=r,n.exports.extractVersion=t.extractVersion,n.exports.disableLog=t.disableLog;var o=e("./chrome/chrome_shim")||null,s=e("./edge/edge_shim")||null,a=e("./firefox/firefox_shim")||null,c=e("./safari/safari_shim")||null;switch(r.browser){case"chrome":if(!o||!o.shimPeerConnection)return void i("Chrome shim is not included in this adapter release.");i("adapter.js shimming chrome."),n.exports.browserShim=o,o.shimGetUserMedia(),o.shimMediaStream(),t.shimCreateObjectURL(),o.shimSourceObject(),o.shimPeerConnection(),o.shimOnTrack();break;case"firefox":if(!a||!a.shimPeerConnection)return void i("Firefox shim is not included in this adapter release.");i("adapter.js shimming firefox."),n.exports.browserShim=a,a.shimGetUserMedia(),t.shimCreateObjectURL(),a.shimSourceObject(),a.shimPeerConnection(),a.shimOnTrack();break;case"edge":if(!s||!s.shimPeerConnection)return void i("MS edge shim is not included in this adapter release.");i("adapter.js shimming edge."),n.exports.browserShim=s,s.shimGetUserMedia(),t.shimCreateObjectURL(),s.shimPeerConnection();break;case"safari":if(!c)return void i("Safari shim is not included in this adapter release.");i("adapter.js shimming safari."),n.exports.browserShim=c,c.shimGetUserMedia();break;default:i("Unsupported browser!")}}()},{"./chrome/chrome_shim":3,"./edge/edge_shim":1,"./firefox/firefox_shim":5,"./safari/safari_shim":7,"./utils":8}],3:[function(e,n,i){var r=e("../utils.js").log,o=e("../utils.js").browserDetails,s={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=("undefined"==typeof window?"undefined":t(window))||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var n=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(t){var i=new Event("track");i.track=t.track,i.receiver={track:t.track},i.streams=[e.stream],n.dispatchEvent(i)}),e.stream.getTracks().forEach(function(n){var t=new Event("track");t.track=n,t.receiver={track:n},t.streams=[e.stream],this.dispatchEvent(t)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==("undefined"==typeof window?"undefined":t(window))&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var n=this;return this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){n.src&&URL.revokeObjectURL(n.src),n.src=URL.createObjectURL(e)}),void e.addEventListener("removetrack",function(){n.src&&URL.revokeObjectURL(n.src),n.src=URL.createObjectURL(e)})):void(this.src="")}}))},shimPeerConnection:function(){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,n){return r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy),new webkitRTCPeerConnection(e,n)},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}));var e=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(n,t,i){var r=this,o=arguments;if(arguments.length>0&&"function"==typeof n)return e.apply(this,arguments);if(0===e.length&&(0===arguments.length||"function"!=typeof arguments[0]))return e.apply(this,[]);var s=function(e){var n={},t=e.result();return t.forEach(function(e){var t={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(n){t[n]=e.stat(n)}),n[t.id]=t}),n},a=function(e){return new Map(Object.keys(e).map(function(n){return[n,e[n]]}))};if(arguments.length>=2){var c=function(e){o[1](a(s(e)))};return e.apply(this,[c,arguments[0]])}return new Promise(function(n,t){e.apply(r,[function(e){n(a(s(e)))},t])}).then(t,i)},o.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=arguments,t=this,i=new Promise(function(i,r){n.apply(t,[e[0],i,r])});return e.length<2?i:i.then(function(){e[1].apply(null,[])},function(n){e.length>=3&&e[2].apply(null,[n])})}}),o.version<52&&["createOffer","createAnswer"].forEach(function(e){var n=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==t(arguments[0])){var i=1===arguments.length?arguments[0]:void 0;return new Promise(function(t,r){n.apply(e,[t,r,i])})}return n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var n=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};n.exports={shimMediaStream:s.shimMediaStream,shimOnTrack:s.shimOnTrack,shimSourceObject:s.shimSourceObject,shimPeerConnection:s.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":8,"./getusermedia":4}],4:[function(e,n,i){var r=e("../utils.js").log;n.exports=function(){var e=function(e){if("object"!=("undefined"==typeof e?"undefined":t(e))||e.mandatory||e.optional)return e;var n={};return Object.keys(e).forEach(function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var r="object"==t(e[i])?e[i]:{ideal:e[i]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,n){return e?e+n.charAt(0).toUpperCase()+n.slice(1):"deviceId"===n?"sourceId":n};if(void 0!==r.ideal){n.optional=n.optional||[];var s={};"number"==typeof r.ideal?(s[o("min",i)]=r.ideal,n.optional.push(s),s={},s[o("max",i)]=r.ideal,n.optional.push(s)):(s[o("",i)]=r.ideal,n.optional.push(s))}void 0!==r.exact&&"number"!=typeof r.exact?(n.mandatory=n.mandatory||{},n.mandatory[o("",i)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(n.mandatory=n.mandatory||{},n.mandatory[o(e,i)]=r[e])})}}),e.advanced&&(n.optional=(n.optional||[]).concat(e.advanced)),n},n=function(n,i){if(n=JSON.parse(JSON.stringify(n)),n&&n.audio&&(n.audio=e(n.audio)),n&&"object"==t(n.video)){var o=n.video.facingMode;if(o=o&&("object"==("undefined"==typeof o?"undefined":t(o))?o:{ideal:o}),o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete n.video.facingMode,"environment"===o.exact||"environment"===o.ideal))return navigator.mediaDevices.enumerateDevices().then(function(t){t=t.filter(function(e){return"videoinput"===e.kind});var s=t.find(function(e){return e.label.toLowerCase().indexOf("back")!==-1})||t.length&&t[t.length-1];return s&&(n.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),n.video=e(n.video),r("chrome: "+JSON.stringify(n)),i(n)});n.video=e(n.video)}return r("chrome: "+JSON.stringify(n)),i(n)},i=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},o=function(e,t,r){n(e,function(e){navigator.webkitGetUserMedia(e,t,function(e){r(i(e))})})};navigator.getUserMedia=o;var s=function(e){return new Promise(function(n,t){navigator.getUserMedia(e,n,t)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:s,enumerateDevices:function(){return new Promise(function(e){var n={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(t){e(t.map(function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return n(e,function(e){return a(e).then(function(n){if(e.audio&&!n.getAudioTracks().length||e.video&&!n.getVideoTracks().length)throw n.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return n},function(e){return Promise.reject(i(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return s(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":8}],5:[function(e,n,i){var r=e("../utils").browserDetails,o={shimOnTrack:function(){"object"!=("undefined"==typeof window?"undefined":t(window))||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(n){var t=new Event("track");t.track=n,t.receiver={track:n},t.streams=[e.stream],this.dispatchEvent(t)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==("undefined"==typeof window?"undefined":t(window))&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==("undefined"==typeof window?"undefined":t(window))&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,n){if(r.version<38&&e&&e.iceServers){for(var t=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];if(o.hasOwnProperty("urls"))for(var s=0;s<o.urls.length;s++){var a={url:o.urls[s]};0===o.urls[s].indexOf("turn")&&(a.username=o.username,a.credential=o.credential),t.push(a)}else t.push(e.iceServers[i])}e.iceServers=t}return new mozRTCPeerConnection(e,n)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var n=function(e){var n=new Map;return Object.keys(e).forEach(function(t){n.set(t,e[t]),n[t]=e[t]}),n},i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,t,s){return o.apply(this,[e||null]).then(function(e){if(r.version<48&&(e=n(e)),r.version<53&&!t)try{e.forEach(function(e){e.type=i[e.type]||e.type})}catch(n){if("TypeError"!==n.name)throw n;e.forEach(function(n,t){e.set(t,Object.assign({},n,{type:i[n.type]||n.type}))})}return e}).then(t,s)}}}};n.exports={shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":8,"./getusermedia":6}],6:[function(e,n,i){var r=e("../utils").log,o=e("../utils").browserDetails;n.exports=function(){var e=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},n=function(n,i,s){var a=function(e){if("object"!=("undefined"==typeof e?"undefined":t(e))||e.require)return e;var n=[];return Object.keys(e).forEach(function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var r=e[i]="object"==t(e[i])?e[i]:{ideal:e[i]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||n.push(i),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[i]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var o={};"number"==typeof r.ideal?o[i]={min:r.ideal,max:r.ideal}:o[i]=r.ideal,e.advanced.push(o),delete r.ideal,Object.keys(r).length||delete e[i]}}}),n.length&&(e.require=n),e};return n=JSON.parse(JSON.stringify(n)),o.version<38&&(r("spec: "+JSON.stringify(n)),n.audio&&(n.audio=a(n.audio)),n.video&&(n.video=a(n.video)),r("ff37: "+JSON.stringify(n))),navigator.mozGetUserMedia(n,i,function(n){s(e(n))})},i=function(e){return new Promise(function(t,i){n(e,t,i)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var n=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(n)})},o.version<41){var s=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return s().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(o.version<49){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(n){return a(n).then(function(e){if(n.audio&&!e.getAudioTracks().length||n.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(n){return Promise.reject(e(n))})}}navigator.getUserMedia=function(e,t,i){return o.version<44?n(e,t,i):(console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),void navigator.mediaDevices.getUserMedia(e).then(t,i))}}},{"../utils":8}],7:[function(e,n,t){var i={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};n.exports={shimGetUserMedia:i.shimGetUserMedia}},{}],8:[function(e,n,i){var r=!0,o={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+("undefined"==typeof e?"undefined":t(e))+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"==("undefined"==typeof window?"undefined":t(window))){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,n,t){var i=e.match(n);return i&&i.length>=t&&parseInt(i[t],10)},detectBrowser:function(){var e={};if(e.browser=null,e.version=null,"undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1)}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2)}return e},shimCreateObjectURL:function(){if("object"==("undefined"==typeof window?"undefined":t(window))&&window.HTMLMediaElement&&"srcObject"in window.HTMLMediaElement.prototype){var e=URL.createObjectURL.bind(URL),n=URL.revokeObjectURL.bind(URL),i=new Map,r=0;URL.createObjectURL=function(n){if("getTracks"in n){var t="polyblob:"+ ++r;return i.set(t,n),console.log("URL.createObjectURL(stream) is deprecated! Use elem.srcObject = stream instead!"),t}return e(n)},URL.revokeObjectURL=function(e){n(e),i.delete(e)};var o=Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,"src");Object.defineProperty(window.HTMLMediaElement.prototype,"src",{get:function(){return o.get.apply(this)},set:function(e){return this.srcObject=i.get(e)||null,o.set.apply(this,[e])}})}}};n.exports={log:o.log,disableLog:o.disableLog,browserDetails:o.detectBrowser(),extractVersion:o.extractVersion,shimCreateObjectURL:o.shimCreateObjectURL}},{}]},{},[2]);var b=function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.name=n,this.wasClean=t.wasClean||!1,this.code=t.code||0,this.reason=t.reason||""},C=function(){function e(){i(this,e)}return r(e,null,[{key:"isBrowser",value:function(){return"undefined"!=typeof window&&("undefined"==typeof process||"node"!==process.title)}},{key:"isSocket",value:function(e){return"WebSocket"===e.constructor.name}},{key:"isURL",value:function(e){var n="^(?:(?:wss|ws|http|https)://)(?:\\S+(?::\\S*)?@)?(?:",t="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))?";return n+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+t+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",!!new RegExp(n,"i").exec(e)}},{key:"require",value:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}(function(e){try{return require(e)}catch(n){return void console.error(e+" could not be found: "+n)}})},{key:"requireLib",value:function(n){switch(n){case e.WEB_RTC_LIB:return e.isBrowser()?window:e.require("wrtc");case e.WEB_SOCKET_LIB:return e.isBrowser()?window.WebSocket:e.require("ws");case e.TEXT_ENCODING_LIB:return e.isBrowser()?window:e.require("text-encoding");case e.EVENT_SOURCE_LIB:return e.isBrowser()?window.EventSource:e.require("eventsource");case e.FETCH:return e.isBrowser()?window.fetch:e.require("node-fetch");case e.CLOSE_EVENT:return e.isBrowser()?window.CloseEvent:b;default:return void console.error(n+" is unknown lib constant. See Util")}}},{key:"WEB_RTC_LIB",get:function(){return 1}},{key:"WEB_SOCKET_LIB",get:function(){return 2}},{key:"TEXT_ENCODING_LIB",get:function(){return 3}},{key:"EVENT_SOURCE_LIB",get:function(){return 4}},{key:"FETCH",get:function(){return 5}},{key:"CLOSE_EVENT",get:function(){return 6}}]),e}(),O=C.requireLib(C.WEB_RTC_LIB),_=C.requireLib(C.CLOSE_EVENT),k=3e4,I=5e3,S=function(e){function n(e,t){i(this,n);var r=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return r.iceServers=t,r}return s(n,e),r(n,[{key:"onMessage",value:function(e,t,i,r){var s=this,a=e.webChannel,c=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",this).call(this,a,t);c||(c=new T,o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setItem",this).call(this,a,t,c)),"offer"in r&&(c.pc=this.createPeerConnection(function(e){a.sendInnerTo(t,s.id,{candidate:e})}),this.listenOnDataChannel(c.pc,function(e){setTimeout(function(){return o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeItem",s).call(s,a,t)},I),Ce.get(ye).onChannel(a,e,t)}),this.createAnswer(c.pc,r.offer,c.candidates).then(function(e){return a.sendInnerTo(t,s.id,{answer:e})}).catch(function(e){return console.error("During Establishing dataChannel connection over webChannel: "+e.message)})),"answer"in r?c.pc.setRemoteDescription(r.answer).then(function(){return c.pc.addReceivedCandidates(c.candidates)}).catch(function(e){return console.error("Set answer (webChannel): "+e.message)}):"candidate"in r&&this.addIceCandidate(c,r.candidate)}},{key:"connectOverWebChannel",value:function(e,t){var i=this,r=new T(this.createPeerConnection(function(n){e.sendInnerTo(t,i.id,{candidate:n})}));return o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setItem",this).call(this,e,t,r),new Promise(function(s,a){setTimeout(a,k,"WebRTC connect timeout"),i.createDataChannel(r.pc,function(r){setTimeout(function(){return o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeItem",i).call(i,e,t)},I),s(r)}),i.createOffer(r.pc).then(function(n){return e.sendInnerTo(t,i.id,{offer:n})}).catch(a)})}},{key:"listenFromSignaling",value:function(e,t){var i=this;e.onmessage=function(r){var s=JSON.parse(r.data);if("id"in s&&"data"in s){var a=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",i).call(i,e,s.id);a||(a=new T(i.createPeerConnection(function(n){1===e.readyState&&e.send(JSON.stringify({id:s.id,data:{candidate:n}}))})),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setItem",i).call(i,e,s.id,a)),"offer"in s.data?(i.listenOnDataChannel(a.pc,function(r){setTimeout(function(){return o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeItem",i).call(i,e,s.id)},I),t(r)}),i.createAnswer(a.pc,s.data.offer,a.candidates).then(function(n){e.send(JSON.stringify({id:s.id,data:{answer:n}}))}).catch(function(e){console.error("During establishing data channel connection through signaling: "+e.message)})):"candidate"in s.data&&i.addIceCandidate(a,s.data.candidate)}}}},{key:"connectOverSignaling",value:function(e,t){var i=this,r=new T(this.createPeerConnection(function(n){1===e.readyState&&e.send(JSON.stringify({data:{candidate:n}}))}));return o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setItem",this).call(this,e,t,r),new Promise(function(s,a){e.onclose=function(e){return a(e.reason)},e.onmessage=function(s){try{var c=JSON.parse(s.data);"data"in c&&("answer"in c.data?r.pc.setRemoteDescription(c.data.answer).then(function(){return r.pc.addReceivedCandidates(r.candidates)}).catch(function(e){return a("Set answer (signaling): "+e.message)}):"candidate"in c.data&&i.addIceCandidate(o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getItem",i).call(i,e,t),c.data.candidate));
}catch(n){a("Unknown message from the server "+e.url+": "+s.data)}},i.createDataChannel(r.pc,function(r){setTimeout(function(){return o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeItem",i).call(i,e,t)},I),s(r)}),i.createOffer(r.pc).then(function(n){return e.send(JSON.stringify({data:{offer:n}}))}).catch(a)})}},{key:"createOffer",value:function(e){return e.createOffer().then(function(n){return e.setLocalDescription(n)}).then(function(){return{type:e.localDescription.type,sdp:e.localDescription.sdp}})}},{key:"createAnswer",value:function(e,n,t){return e.setRemoteDescription(n).then(function(){return e.addReceivedCandidates(t),e.createAnswer()}).then(function(n){return e.setLocalDescription(n)}).then(function(){return{type:e.localDescription.type,sdp:e.localDescription.sdp}})}},{key:"createPeerConnection",value:function(e){var n=this,t=new O.RTCPeerConnection({iceServers:this.iceServers});return t.isRemoteDescriptionSet=!1,t.addReceivedCandidates=function(e){t.isRemoteDescriptionSet=!0;var i=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;n.addIceCandidate({pc:t},c)}}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}},t.onicecandidate=function(n){if(null!==n.candidate){var t={candidate:n.candidate.candidate,sdpMid:n.candidate.sdpMid,sdpMLineIndex:n.candidate.sdpMLineIndex};e(t)}},t}},{key:"createDataChannel",value:function(e,n){var t=e.createDataChannel(null);t.onopen=function(e){return n(t)},this.setUpOnDisconnect(e,t)}},{key:"listenOnDataChannel",value:function(e,n){var t=this;e.ondatachannel=function(i){t.setUpOnDisconnect(e,i.channel),i.channel.onopen=function(e){return n(i.channel)}}}},{key:"setUpOnDisconnect",value:function(e,n){e.oniceconnectionstatechange=function(){"disconnected"===e.iceConnectionState&&n.onclose&&n.onclose(new _("disconnect",{code:4201,reason:"disconnected"}))}}},{key:"addIceCandidate",value:function(e,n){null!==e&&e.pc&&e.pc.isRemoteDescriptionSet?e.pc.addIceCandidate(new O.RTCIceCandidate(n)).catch(function(e){return console.error("Add ICE candidate: "+e.message)}):e.candidates[e.candidates.length]=n}}]),n}(l),T=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];i(this,e),this.pc=n,this.candidates=t},P=C.requireLib(C.WEB_SOCKET_LIB),E=2e3,R=function(e){function n(){return i(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s(n,e),r(n,[{key:"connect",value:function(e){return new Promise(function(n,t){try{!function(){var i=new P(e);i.onopen=function(){return n(i)},setTimeout(function(){i.readyState!==i.OPEN&&t("WebSocket connection timeout with "+e+" within "+E+"ms")},E)}()}catch(e){t(e.message)}})}}]),n}(l),j=C.requireLib(C.EVENT_SOURCE_LIB),U=C.requireLib(C.FETCH),L=C.requireLib(C.CLOSE_EVENT),M=5e3,D=function(e){function n(){return i(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s(n,e),r(n,[{key:"connect",value:function(e){return new Promise(function(n,t){try{!function(){var i=new x(e);i.onopen=function(){return n(i)},i.onerror=function(e){return t(e.message)},setTimeout(function(){t("Authentication event has not been received from "+e+" within "+M+"ms")},M)}()}catch(e){t(e.message)}})}}]),n}(l),x=function(){function e(n){var t=this;i(this,e),this.auth="",this._onopen=function(){},this._onerror=function(){},this._onclose=function(){},this.es=new j(n),this.es.addEventListener("auth",function(e){t.auth=e.data,t._onopen()}),this.es.addEventListener("close",function(e){var n=JSON.parse(e.data);t.es.close(),t._onclose(new L("close",{wasClean:!0,code:n.code,reason:n.reason}))}),this.es.onerror=this._onerror}return r(e,[{key:"close",value:function(){this.es.close(),this._onclose(new L("close",{wasClean:!0,code:1e3}))}},{key:"send",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";U(this.url,{method:"POST",body:this.auth+"@"+n}).then(function(n){200!==n.status&&e._onerror(new Error(n.status+": "+n.statusText))}).catch(function(n){return e._onerror(n)})}},{key:"CONNECTING",get:function(){return void 0!==this.es.OPEN?this.es.OPEN:0}},{key:"OPEN",get:function(){return void 0!==this.es.OPEN?this.es.OPEN:1}},{key:"CLOSED",get:function(){return void 0!==this.es.OPEN?this.es.OPEN:2}},{key:"url",get:function(){return this.es.url}},{key:"readyState",get:function(){return this.es.readyState}},{key:"onopen",get:function(){return this._onopen},set:function(e){this._onopen=e}},{key:"onmessage",get:function(){return this.es.onmessage},set:function(e){this.es.onmessage=e}},{key:"onclose",get:function(){return this._onclose},set:function(e){this._onclose=e}},{key:"onerror",get:function(){return this._onerror},set:function(e){this._onerror=e}}]),e}(),W=function(e){function n(e){i(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.WS=[ve],t.WR=[pe],t.WS_WR=[ve,pe],t.WR_WS=[pe,ve],t}return s(n,e),r(n,[{key:"connectTo",value:function(e,t){var i=this;return new Promise(function(r,s){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setPendingRequest",i).call(i,e,t,{resolve:r,reject:s}),e.sendInnerTo(t,i.id,i.availableConnectors(e))})}},{key:"availableConnectors",value:function(e){var n={},t=[];return void 0!==C.requireLib(C.WEB_RTC_LIB)&&(t[t.length]=pe),""!==e.settings.listenOn&&(t[t.length]=ve,n.listenOn=e.settings.listenOn),2===t.length&&t[0]!==e.settings.connector&&t.reverse(),n.connectors=t,n}},{key:"onChannel",value:function(e,t,i){var r=this;e.initChannel(t,i).then(function(t){var s=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getPendingRequest",r).call(r,e,i);null!==s&&s.resolve(t)})}},{key:"onMessage",value:function(e,t,i,r){var s=this,a=e.webChannel,c=this.availableConnectors(a),u=c.connectors;"failedReason"in r?o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getPendingRequest",this).call(this,a,t).reject(r.failedReason):"shouldConnect"in r?this.isEqual(r.shouldConnect,this.WS)?Ce.get(ve).connect(r.listenOn).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}).catch(function(e){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getPendingRequest",s).call(s,a,t).reject("Failed to establish a socket: "+e)}):this.isEqual(r.shouldConnect,this.WS_WR)&&Ce.get(ve).connect(r.listenOn).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}).catch(function(e){return Ce.get(pe,a.settings.iceServers).connectOverWebChannel(a,t)}).then(function(e){return s.onChannel(a,e,t)}).catch(function(e){"feedbackOnFail"in r&&r.feedbackOnFail===!0?a.sendInnerTo(t,s.id,{tryOn:s.WS,listenOn:c.listenOn}):o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getPendingRequest",s).call(s,a,t).reject("Failed to establish a socket and then a data channel: "+e)}):"tryOn"in r&&this.isEqual(r.tryOn,this.WS)?Ce.get(ve).connect(r.listenOn).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}).catch(function(e){return a.sendInnerTo(t,s.id,{failedReason:"Failed to establish a socket: "+e})}):"connectors"in r&&(this.isValid(r.connectors)?(0===r.connectors.length&&(0===u.length||this.isEqual(u,this.WS)?a.sendInnerTo(t,this.id,{failedReason:"No common connectors"}):a.sendInnerTo(t,this.id,{shouldConnect:this.WS,listenOn:c.listenOn})),this.isEqual(r.connectors,this.WS)&&(0===u.length||this.isEqual(u,this.WS)?this.ws(a,t,r.listenOn):this.wsWs(a,t,r.listenOn,c.listenOn)),this.isEqual(r.connectors,this.WR)&&(0===u.length?a.sendInnerTo(t,this.id,{failedReason:"No common connectors"}):this.isEqual(u,this.WS)?a.sendInnerTo(t,this.id,{shouldConnect:this.WS,listenOn:c.listenOn}):this.isEqual(u,this.WR)?Ce.get(pe,a.settings.iceServers).connectOverWebChannel(a,t).then(function(e){return s.onChannel(a,e,t)}).catch(function(e){a.sendInnerTo(t,s.id,{failedReason:"Failed establish a data channel: "+e})}):this.isEqual(u,this.WS_WR)?a.sendInnerTo(t,this.id,{shouldConnect:this.WS_WR,listenOn:c.listenOn}):this.isEqual(u,this.WR_WS)&&Ce.get(pe,a.settings.iceServers).connectOverWebChannel(a,t).then(function(e){return s.onChannel(a,e,t)}).catch(function(e){a.sendInnerTo(t,s.id,{shouldConnect:s.WS,listenOn:c.listenOn})})),this.isEqual(r.connectors,this.WS_WR)&&(0===u.length?this.ws(a,t,r.listenOn):this.isEqual(u,this.WS)?this.wsWs(a,t,r.listenOn,c.listenOn):this.isEqual(u,this.WR)?Ce.get(ve).connect(r.listenOn).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}).catch(function(e){return Ce.get(pe,a.settings.iceServers).connectOverWebChannel(a,t)}).then(function(e){return s.onChannel(a,e,t)}).catch(function(e){return a.sendInnerTo(t,s.id,{failedReason:"Failed to establish a socket and then a data channel: "+e})}):this.isEqual(u,this.WS_WR)?Ce.get(ve).connect(r.listenOn).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}):this.isEqual(u,this.WR_WS)?a.sendInnerTo(t,this.id,{shouldConnect:this.WS_WR,listenOn:c.listenOn}):Ce.get(ve).connect(r.listenOn).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}).catch(function(e){return Ce.get(pe,a.settings.iceServers).connectOverWebChannel(a,t)}).then(function(e){return s.onChannel(a,e,t)}).catch(function(e){return a.sendInnerTo(t,s.id,{shouldConnect:s.WS,listenOn:c.listenOn})})),this.isEqual(r.connectors,this.WR_WS)&&(0===u.length?this.ws(a,t,r.listenOn):this.isEqual(u,this.WS)?this.wsWs(a,t,r.listenOn,c.listenOn):this.isEqual(u,this.WR)?Ce.get(pe,a.settings.iceServers).connectOverWebChannel(a,t).then(function(e){return s.onChannel(a,e,t)}).catch(function(e){return Ce.get(ve).connect(r.listenOn)}).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}).catch(function(e){return a.sendInnerTo(t,s.id,{failedReason:"Failed to establish a data channel and then a socket: "+e})}):this.isEqual(u,this.WS_WR)?a.sendInnerTo(t,this.id,{shouldConnect:this.WS_WR,feedbackOnFail:!0,listenOn:c.listenOn}):this.isEqual(u,this.WR_WS)&&Ce.get(pe,a.settings.iceServers).connectOverWebChannel(a,t).then(function(e){return s.onChannel(a,e,t)}).catch(function(e){return Ce.get(ve).connect(r.listenOn)}).then(function(e){e.send(JSON.stringify({wcId:a.id,senderId:a.myId})),s.onChannel(a,e,t)}).catch(function(e){return a.sendInnerTo(t,s.id,{shouldConnect:s.WS,listenOn:c.listenOn})}))):a.sendInnerTo(t,this.id,{failedReason:"Unknown connectors: "+r.connectors}))}},{key:"wsWs",value:function(e,n,t,i){var r=this;Ce.get(ve).connect(t).then(function(t){t.send(JSON.stringify({wcId:e.id,senderId:e.myId})),r.onChannel(e,t,n)}).catch(function(t){e.sendInnerTo(n,r.id,{shouldConnect:r.WS,listenOn:i})})}},{key:"ws",value:function(e,n,t){var i=this;Ce.get(ve).connect(t).then(function(t){t.send(JSON.stringify({wcId:e.id,senderId:e.myId})),i.onChannel(e,t,n)}).catch(function(t){e.sendInnerTo(n,i.id,{failedReason:"Failed to establish a socket: "+t})})}},{key:"isValid",value:function(e){return!!(this.isEqual(e,this.WS)||this.isEqual(e,this.WR)||this.isEqual(e,this.WS_WR)||this.isEqual(e,this.WR_WS))}},{key:"isEqual",value:function(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}}]),n}(l),N=function(){function e(n,t,r){i(this,e),this.channel=n,this.webChannel=null,this.peerId=-1,this.send=null,C.isBrowser()?(n.binaryType="arraybuffer",this.send=this.sendBrowser):C.isSocket(n)?this.send=this.sendInNodeThroughSocket:(n.binaryType="arraybuffer",this.send=this.sendInNodeThroughDataChannel)}return r(e,[{key:"sendBrowser",value:function(e){if(this.isOpen())try{this.channel.send(e)}catch(e){console.error("Channel send: "+e.message)}}},{key:"sendInNodeThroughSocket",value:function(e){if(this.isOpen())try{this.channel.send(e,{binary:!0})}catch(e){console.error("Channel send: "+e.message)}}},{key:"sendInNodeThroughDataChannel",value:function(e){this.sendBrowser(e.slice(0))}},{key:"clearHandlers",value:function(){this.onMessage=function(){},this.onClose=function(){},this.onError=function(){}}},{key:"isOpen",value:function(){var e=this.channel.readyState;return 1===e||"open"===e}},{key:"close",value:function(){this.channel.close()}},{key:"onMessage",set:function(e){!C.isBrowser()&&C.isSocket(this.channel)?this.channel.onmessage=function(n){e(new Uint8Array(n.data).buffer)}:this.channel.onmessage=function(n){return e(n.data)}}},{key:"onClose",set:function(e){var n=this;this.channel.onclose=function(t){null!==n.webChannel&&e(t)?(n.webChannel.members.splice(n.webChannel.members.indexOf(n.peerId),1),n.webChannel.onPeerLeave(n.peerId)):e(t)}}},{key:"onError",set:function(e){this.channel.onerror=function(n){return e(n)}}}]),e}(),q=function(){function e(n,t){i(this,e),this.webChannel=n,this.url=null,this.key=null,this.con=null,this.onChannel=t}return r(e,[{key:"open",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.generateKey();return new Promise(function(i,r){n.getConnectionService(e).connect(e).then(function(o){o.onclose=function(e){return r(e.reason)},o.onerror=function(e){return r(e.message)},o.onmessage=function(s){try{var a=JSON.parse(s.data);"opened"in a?a.opened?i(n.listenOnOpen(o,t)):r("Could not open with "+t):r("Unknown message from "+e+": "+s.data)}catch(e){r("Server responce is not a JSON string: "+e.message)}},o.send(JSON.stringify({open:t}))}).catch(function(e){r(e)})})}},{key:"openExisted",value:function(e,n){var t=this;return new Promise(function(i,r){e.onclose=function(e){return r(e.reason)},e.onerror=function(e){return r(e.message)},e.onmessage=function(o){try{var s=JSON.parse(o.data);"opened"in s?s.opened?i(t.listenOnOpen(e,n)):r("Could not open with "+n):r("Unknown message from "+e.url+": "+o.data)}catch(e){r("Server responce is not a JSON string: "+e.message)}},e.send(JSON.stringify({open:n}))})}},{key:"join",value:function(e,n){var t=this;return new Promise(function(i,r){t.getConnectionService(e).connect(e).then(function(o){o.onclose=function(e){return r(e.reason)},o.onerror=function(e){return r(e.message)},o.onmessage=function(s){try{var a=JSON.parse(s.data);"opened"in a?a.opened?(t.listenOnOpen(o,n),i({opened:!0,sigCon:o})):"useThis"in a?a.useThis?i({opened:!1,con:o}):r("Open a gate with bot server is not possible"):Ce.get(pe,t.webChannel.settings.iceServers).connectOverSignaling(o,n).then(function(e){return i({opened:!1,con:e,sigCon:o})}).catch(r):r("Unknown message from "+e+": "+s.data)}catch(e){r(e.message)}},o.send(JSON.stringify({join:n}))}).catch(r)})}},{key:"isOpen",value:function(){return null!==this.con&&this.con.readyState===this.con.OPEN}},{key:"getOpenData",value:function(){return this.isOpen()?{url:this.url,key:this.key}:null}},{key:"close",value:function(){this.isOpen()&&this.con.close()}},{key:"getConnectionService",value:function(e){if(C.isURL(e))return e.search(/^wss?/)!==-1?Ce.get(ve):Ce.get(ge);throw new Error(e+" is not a valid URL")}},{key:"listenOnOpen",value:function(e,n){var t=this;return Ce.get(pe,this.webChannel.settings.iceServers).listenFromSignaling(e,function(e){return t.onChannel(e)}),this.con=e,this.con.onclose=function(e){t.key=null,t.con=null,t.url=null,t.webChannel.onClose(e)},this.key=n,e.url.endsWith("/")?this.url=e.url.substr(0,e.url.length-1):this.url=e.url,{url:this.url,key:n}}},{key:"generateKey",value:function(){for(var e=5,n=0,t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i="",r=e+Math.round(Math.random()*n),o=0;o<r;o++)i+=t[Math.round(Math.random()*(t.length-1))];return i}}]),e}(),B=2147483647,J=5e3,A=1e4,F=1,z=2,V=3,H=4,G=5,K=function(){function e(n){var t=this;i(this,e),this.settings=n,this.channels=new Set,this.onJoin=function(){},this.manager=Ce.get(this.settings.topology),this.msgBld=Ce.get(we),this.members=[],this.generatedIds=new Set,this.pingTime=0,this.maxTime=0,this.pingFinish=function(){},this.pongNb=0,this.gate=new q(this,function(e){return t.addChannel(e)}),this.id=this.generateId(),this.myId=this.generateId(),this.onPeerJoin=function(){},this.onPeerLeave=function(){},this.onMessage=function(){},this.onClose=function(){}}return r(e,[{key:"join",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.settings.signalingURL;return new Promise(function(i,r){"WebSocket"!==e.constructor.name?n.gate.join(t,e).then(function(t){t.opened?i():(n.onJoin=function(){n.gate.openExisted(t.sigCon,e).then(i)},n.initChannel(t.con).catch(r))}).catch(r):(n.onJoin=i,n.initChannel(e).catch(r))})}},{key:"invite",value:function(e){var n=this;return"string"==typeof e||e instanceof String?C.isURL(e)?Ce.get(ve).connect(e).then(function(e){return e.send(JSON.stringify({wcId:n.id})),n.addChannel(e)}):Promise.reject(e+" is not a valid URL"):"WebSocket"===e.constructor.name?this.addChannel(e):Promise.reject(e+" is not a valid URL")}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return C.isURL(this.settings.signalingURL)?null!==e?this.gate.open(this.settings.signalingURL,e):this.gate.open(this.settings.signalingURL):Promise.reject(this.settings.signalingURL+" is not a valid URL")}},{key:"close",value:function(){this.gate.close()}},{key:"isOpen",value:function(){return this.gate.isOpen()}},{key:"getOpenData",value:function(){return this.gate.getOpenData()}},{key:"leave",value:function(){0!==this.channels.size&&(this.members=[],this.pingTime=0,this.gate.close(),this.manager.leave(this))}},{key:"send",value:function(e){var n=this;0!==this.channels.size&&this.msgBld.handleUserMessage(e,this.myId,null,function(e){n.manager.broadcast(n,e)})}},{key:"sendTo",value:function(e,n){var t=this;0!==this.channels.size&&this.msgBld.handleUserMessage(n,this.myId,e,function(n){t.manager.sendTo(e,t,n)},!1)}},{key:"ping",value:function(){var e=this;return 0!==this.channels.size&&0===this.pingTime?new Promise(function(n,t){0===e.pingTime&&(e.pingTime=Date.now(),e.maxTime=0,e.pongNb=0,e.pingFinish=function(e){return n(e)},e.manager.broadcast(e,e.msgBld.msg(H,e.myId)),setTimeout(function(){return n(J)},J))}):Promise.reject("No peers to ping")}},{key:"addChannel",value:function(e){var n=this;return this.initChannel(e).then(function(e){var t=n.msgBld.msg(V,n.myId,e.peerId,{manager:n.manager.id,wcId:n.id});return e.send(t),n.manager.add(e)})}},{key:"onPeerJoin$",value:function(e){this.members[this.members.length]=e,this.onPeerJoin(e)}},{key:"onPeerLeave$",value:function(e){this.members.splice(this.members.indexOf(e),1),this.onPeerLeave(e)}},{key:"sendInnerTo",value:function(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(i)this.manager.sendInnerTo(e,this,t);else if(Number.isInteger(e)){var r=this.msgBld.msg(z,this.myId,e,{serviceId:n,data:t});this.manager.sendInnerTo(e,this,r)}else e.send(this.msgBld.msg(z,this.myId,e.peerId,{serviceId:n,data:t}))}},{key:"sendInner",value:function(e,n){this.manager.sendInner(this,this.msgBld.msg(z,this.myId,null,{serviceId:e,data:n}))}},{key:"onChannelMessage",value:function(e,n){var t=this,i=this.msgBld.readHeader(n);if(i.code===F)this.msgBld.readUserMessage(this,i.senderId,n,function(e,n){t.onMessage(i.senderId,e,n)});else{var r=this.msgBld.readInternalMessage(n);switch(i.code){case V:this.settings.topology=r.manager,this.manager=Ce.get(this.settings.topology),this.myId=i.recepientId,this.id=r.wcId,e.peerId=i.senderId;break;case z:0===i.recepientId||this.myId===i.recepientId?this.getService(r.serviceId).onMessage(e,i.senderId,i.recepientId,r.data):this.sendInnerTo(i.recepientId,null,n,!0);break;case H:this.manager.sendTo(i.senderId,this,this.msgBld.msg(G,this.myId));break;case G:var o=Date.now();this.pongNb++,this.maxTime=Math.max(this.maxTime,o-this.pingTime),this.pongNb===this.members.length&&(this.pingFinish(this.maxTime),this.pingTime=0);break;default:throw new Error('Unknown message type code: "'+i.code+'"')}}}},{key:"initChannel",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;t===-1&&(t=this.generateId());var i=new N(e);return i.peerId=t,i.webChannel=this,i.onMessage=function(e){return n.onChannelMessage(i,e)},i.onClose=function(e){return n.manager.onChannelClose(e,i)},i.onError=function(e){return n.manager.onChannelError(e,i)},Promise.resolve(i)}},{key:"getService",value:function(e){return e===pe?Ce.get(pe,this.settings.iceServers):Ce.get(e)}},{key:"generateId",value:function(){for(var e=this,n=function(){var n=Math.ceil(Math.random()*B);return n===e.myId?"continue":e.members.includes(n)?"continue":e.generatedIds.has(n)?"continue":(e.generatedIds.add(n),setTimeout(function(){return e.generatedIds.delete(n)},A),{v:n})};;){var i=n();switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":t(i)))return i.v}}}}]),e}(),$=C.requireLib(C.TEXT_ENCODING_LIB),X=16365,Q=19,Y=9,Z=65535,ee=1,ne=2,te=3,ie=4,re=5,oe=6,se=7,ae=8,ce=9,ue=10,de=11,le=new WeakMap,he=function(e){function n(){return i(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s(n,e),r(n,[{key:"handleUserMessage",value:function(e,n,t,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this.userDataToType(e),s=o.content;if(s.byteLength<=X){var a=this.initHeader(1,n,t,s.byteLength+Q);a.setUint32(Y,s.byteLength),a.setUint8(13,o.type),a.setUint8(14,r?1:0);var c=new Uint8Array(a.buffer);c.set(s,Q),i(c.buffer)}else for(var u=Math.ceil(Math.random()*Z),d=Math.ceil(s.byteLength/X),l=0;l<d;l++){var h=Math.min(X,s.byteLength-X*l),f=this.initHeader(F,n,t,Q+h);f.setUint32(9,s.byteLength),f.setUint8(13,o.type),f.setUint8(14,r?1:0),f.setUint16(15,u),f.setUint16(17,l);for(var p=new Uint8Array(f.buffer),v=Q,g=X*l,y=g+h,m=g;m<y;m++)p[v++]=s[m];i(p.buffer)}}},{key:"msg",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=(new $.TextEncoder).encode(JSON.stringify(i)),o=r.byteLength+Y,s=this.initHeader(e,n,t,o),a=new Uint8Array(s.buffer);return a.set(r,Y),a.buffer}},{key:"readUserMessage",value:function(e,n,t,i){var r=this,o=new DataView(t),s=o.getUint32(Y),a=o.getUint8(13),c=o.getUint8(14);if(s>X){var u=o.getUint16(15),d=o.getUint16(17),l=this.getBuffer(e,n,u);void 0===l?this.setBuffer(e,n,u,new fe(s,t,d,function(e){i(r.extractUserData(e,a),c)})):l.add(t,d)}else{for(var h=new Uint8Array(t),f=new Uint8Array(t.byteLength-Q),p=Q,v=0;v<f.byteLength;v++)f[v]=h[p++];i(this.extractUserData(f.buffer,a),c)}}},{key:"readInternalMessage",value:function(e){var n=new Uint8Array(e);return JSON.parse((new $.TextDecoder).decode(n.subarray(Y,n.byteLength)))}},{key:"readHeader",value:function(e){var n=new DataView(e);return{code:n.getUint8(0),senderId:n.getUint32(1),recepientId:n.getUint32(5)}}},{key:"initHeader",value:function(e,n,t,i){var r=new DataView(new ArrayBuffer(i));return r.setUint8(0,e),r.setUint32(1,n),r.setUint32(5,t),r}},{key:"extractUserData",value:function(e,n){switch(n){case ee:return e;case ne:return new Uint8Array(e);case te:return(new $.TextDecoder).decode(new Uint8Array(e));case ie:return new Int8Array(e);case re:return new Uint8ClampedArray(e);case oe:return new Int16Array(e);case se:return new Uint16Array(e);case ae:return new Int32Array(e);case ce:return new Uint32Array(e);case ue:return new Float32Array(e);case de:return new Float64Array(e);default:throw new Error("Unknown type")}}},{key:"userDataToType",value:function(e){var n={};if(e instanceof ArrayBuffer)n.type=ee,n.content=new Uint8Array(e);else if(e instanceof Uint8Array)n.type=ne,n.content=e;else if("string"==typeof e||e instanceof String)n.type=te,n.content=(new $.TextEncoder).encode(e);else if(n.content=new Uint8Array(e.buffer),e instanceof Int8Array)n.type=ie;else if(e instanceof Uint8ClampedArray)n.type=re;else if(e instanceof Int16Array)n.type=oe;else if(e instanceof Uint16Array)n.type=se;else if(e instanceof Int32Array)n.type=ae;else if(e instanceof Uint32Array)n.type=ce;else if(e instanceof Float32Array)n.type=ue;else{if(!(e instanceof Float64Array))throw new Error("Unknown data object");n.type=de}return n}},{key:"getBuffer",value:function(e,n,t){var i=le.get(e);if(void 0!==i){var r=i.get(n);if(void 0!==r)return r.get(t)}}},{key:"setBuffer",value:function(e,n,t,i){var r=le.get(e);void 0===r&&(r=new Map,le.set(e,r));var o=r.get(n);void 0===o&&(o=new Map,r.set(n,o)),o.set(t,i)}}]),n}(l),fe=function(){function e(n,t,r,o){i(this,e),this.fullData=new Uint8Array(n),this.currentSize=0,this.action=o,this.add(t,r)}return r(e,[{key:"add",value:function(e,n){var t=new Uint8Array(e),i=e.byteLength;this.currentSize+=i-Q;for(var r=n*X,o=Q;o<i;o++)this.fullData[r++]=t[o];this.currentSize===this.fullData.byteLength&&this.action(this.fullData.buffer)}}]),e}(),pe=0,ve=1,ge=5,ye=2,me=3,we=4,be=new Map,Ce=function(){function e(){i(this,e)}return r(e,null,[{key:"get",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(be.has(e))return be.get(e);var t=void 0;switch(e){case pe:return new S(pe,n);case ve:return new R(ve);case ge:return new D(ge);case ye:return new W(ye);case me:return t=new m(me),be.set(e,t),t;case we:return t=new he(we),be.set(e,t),t;default:throw new Error(e+" is an Unknown service id")}}}]),e}(),Oe=4e3,_e=4001,ke=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.defaultSettings={connector:ve,topology:me,signalingURL:"wss://sigver-coastteam.rhcloud.com:8443",iceServers:[{urls:"stun:turn01.uswest.xirsys.com"}],host:"localhost",port:9e3},this.settings=Object.assign({},this.defaultSettings,n),this.settings.listenOn="ws://"+this.settings.host+":"+this.settings.port,this.server=null,this.webChannels=[],this.onWebChannel=function(){}}return r(e,[{key:"start",value:function(){var e=this;return new Promise(function(n,t){var i=void 0;try{console.log("uws module would be used for Bot server"),i=require("uws").Server}catch(e){console.log(e.message);try{i=require("ws").Server,console.log("ws module is used for Bot server instead")}catch(e){console.log("ERROR: "+e.message+". Thus the Bot server cannot be run"),t(e.message)}}e.server=new i({host:e.settings.host,port:e.settings.port},n);var r=!0,o=!1,s=void 0;try{for(var a,c=e.webChannels[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var u=a.value;u.settings.listenOn=e.settings.listenOn}}catch(e){o=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw s}}e.server.on("error",function(n){console.error("Server error: ",n);var i=!0,r=!1,o=void 0;try{for(var s,a=e.webChannels[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;c.settings.listenOn=""}}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}t("Server error: "+n.messsage)}),e.server.on("connection",function(n){n.onmessage=function(t){try{var i=JSON.parse(t.data);if("join"in i){var r=e.getWebChannel(i.join);null===r?n.send(JSON.stringify({opened:!1,useThis:!1})):(n.send(JSON.stringify({opened:!1,useThis:!0})),r.invite(n))}else"wcId"in i&&!function(){var t=e.getWebChannel(i.wcId);"senderId"in i?null!==t?Ce.get(ye).onChannel(t,n,i.senderId):(n.close(_e,i.wcId+" webChannel was not found (message received from "+i.senderId+")"),console.error(i.wcId+" webChannel was not found (message received from "+i.senderId+")")):null===t?(t=new K(e.settings),t.id=i.wcId,e.addWebChannel(t),t.join(n).then(function(){e.onWebChannel(t)})):0===t.members.length?(e.removeWebChannel(t),t=new K(e.settings),t.id=i.wcId,e.addWebChannel(t),t.join(n).then(function(){e.onWebChannel(t)})):console.error("Bot refused to join "+i.wcId+" webChannel, because it is already in use")}()}catch(e){n.close(Oe,"Unsupported message type: "+e.message),console.error("Unsupported message type: "+e.message)}}})})}},{key:"stop",value:function(){var e=!0,n=!1,t=void 0;try{for(var i,r=this.webChannels[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;o.settings.listenOn=""}}catch(e){n=!0,t=e}finally{try{!e&&r.return&&r.return()}finally{if(n)throw t}}this.server.close()}},{key:"getWebChannel",value:function(e){var n=!0,t=!1,i=void 0;try{for(var r,o=this.webChannels[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var s=r.value;if(e===s.id)return s}}catch(e){t=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(t)throw i}}return null}},{key:"addWebChannel",value:function(e){this.webChannels[this.webChannels.length]=e}},{key:"removeWebChannel",value:function(e){this.webChannels.splice(this.webChannels.indexOf(e),1)}}]),e}();e.create=n,e.BotServer=ke,e.WEB_SOCKET=ve,e.WEB_RTC=pe,Object.defineProperty(e,"__esModule",{value:!0})});
